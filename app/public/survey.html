<!DOCTYPE html>
<html lang="en">
  <head>
    <title>FriendFinder</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <h1>The Cave Social Network</h1>
    <h5>
      Find your perfect match and take them out. A Date? Assassination? You
      decide
    </h5>

    <div class="container">
      <h1>Survey</h1>
      <h5>Take a quick survey to find your match</h5>
      <p>
        The following questions have choices from 1 through 5. If you really
        disagree with the statement, pick 1; if you overwhelmingly agree with
        it, pick 5.
      </p>

      <form>
        <div class="form-group">
          <input
            id="name"
            type="text"
            class="form-control"
            placeholder="Name (Required)"
          />
        </div>
        <div class="form-group">
          <input
            id="photo"
            type="text"
            class="form-control"
            placeholder="Link to Profile Photo (Required)"
          />
        </div>
        <div class="form-group">
          <label for="question1">I like dark places.</label>
          <select class="form-control" id="question1">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question2">My favorite time of day is the night.</label>
          <select class="form-control" id="question2">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question3">Black is my favorite color.</label>
          <select class="form-control" id="question3">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question4">I enjoy martial arts.</label>
          <select class="form-control" id="question4">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question5">I like going to the circus.</label>
          <select class="form-control" id="question5">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question6">Coffee should be its own food group.</label>
          <select class="form-control" id="question6">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question7">I enjoy finishing conversations.</label>
          <select class="form-control" id="question7">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question8">I adore animals, especially as pets.</label>
          <select class="form-control" id="question8">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question9">I work out often.</label>
          <select class="form-control" id="question9">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="question10">I like my coworkers.</label>
          <select class="form-control" id="question10">
            <option value="empty"></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
      </form>

      <div class="text-center">
        <button id="submitBtn" type="submit" class="btn btn-success btn-lg">
          Submit
        </button>
      </div>

      <!-- Modal after survey -->
      <div id="bestFriendModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 class="modal-title">Your New Best Friend</h1>
                </div>
                <div class="modal-body">
                    <h2 id="bestFriend"></h2>
                    <img id="bestFriendPhoto" src="#">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
     </div>


    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

    <script type= "text/javascript">
        // on click event for submit button
        $("#submitBtn").on("click", function(event) {
            event.preventDefault();
        
		    // Form validation
		    var valid = true;
		    if($("#name").val() === "" || $("#photo").val() === "") {
			valid = false;
		    } else if($("#question1").val() === "empty" || $("#question2").val() === "empty" || $("#question3").val() === "empty" || $("#question4").val() === "empty" || $("#question5").val() === "empty" || $("#question6").val() === "empty" || $("#question7").val() === "empty" || $("#question8").val() === "empty" || $("#question9").val() === "empty" || $("#question10").val() === "empty") {
			valid = false;
        }
        
		if(valid === true) {
			var newUser = {
				name: $("#name").val().trim(),
				photo: $("#photo").val().trim(),
				scores: [
					$("#question1").val(),
					$("#question2").val(),
					$("#question3").val(),
					$("#question4").val(),
					$("#question5").val(),
					$("#question6").val(),
					$("#question7").val(),
					$("#question8").val(),
					$("#question9").val(),
					$("#question10").val()
				]
            };
            
            var currentURL = window.location.origin;
            
            // Ajax call for receiving response after POST req
			$.post(currentURL + "/api/friends", newUser, function(data) {
				$("#bestFriend").text(data.name);
				$("#bestFriendPhoto").attr("src", data.photo);
        $("#bestFriendModal").modal("toggle");
        console.log (newUser.name + " is in the Cave")
			});
		} else {
			// Alert if information is missing
			alert("Survey is incomplete! Please check your answers to the questions!");
		}
    });
    
</script>

</body>
</html>
